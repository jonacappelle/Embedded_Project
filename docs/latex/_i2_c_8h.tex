\hypertarget{_i2_c_8h}{}\doxysection{Embedded\+\_\+1\+\_\+\+A\+M\+G8833\+\_\+\+Temp\+\_\+\+Sensor/\+A\+M\+G8833/\+I2C.h File Reference}
\label{_i2_c_8h}\index{Embedded\_1\_AMG8833\_Temp\_Sensor/AMG8833/I2C.h@{Embedded\_1\_AMG8833\_Temp\_Sensor/AMG8833/I2C.h}}


I2C function to read-\/write the I2C bus, based on D\+R\+A\+M\+CO code.  


{\ttfamily \#include $<$stdbool.\+h$>$}\newline
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
void \mbox{\hyperlink{_i2_c_8h_adc2aa003a8bc13c866e90661fa908189}{I\+I\+C\+\_\+\+Init}} (void)
\begin{DoxyCompactList}\small\item\em Setup I2C functionality. \end{DoxyCompactList}\item 
void \mbox{\hyperlink{_i2_c_8h_a20cf9a3b52c6a0e5b84b6e798c8dcb11}{I\+I\+C\+\_\+\+Reset}} (void)
\begin{DoxyCompactList}\small\item\em Resets the I2C interface. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{_i2_c_8h_a47431e985fd340e0e1d8a112bfe9ddcc}{I\+I\+C\+\_\+\+Write\+Buffer}} (uint8\+\_\+t iic\+Address, uint8\+\_\+t $\ast$w\+Buffer, uint8\+\_\+t w\+Length)
\begin{DoxyCompactList}\small\item\em I2C write functionality. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{_i2_c_8h_a64d2f470c338361bb82df486f8002b19}{I\+I\+C\+\_\+\+Read\+Buffer}} (uint8\+\_\+t iic\+Address, uint8\+\_\+t reg\+Command, uint8\+\_\+t $\ast$r\+Buffer, uint8\+\_\+t r\+Length)
\begin{DoxyCompactList}\small\item\em I2C read functionality. \end{DoxyCompactList}\item 
bool \mbox{\hyperlink{_i2_c_8h_a06104f2b83b9e221737ba5a75c6edc4c}{I\+I\+C\+\_\+\+Write\+Read\+Buffer}} (uint8\+\_\+t iic\+Address, uint8\+\_\+t $\ast$w\+Buffer, uint8\+\_\+t w\+Length, uint8\+\_\+t $\ast$r\+Buffer, uint8\+\_\+t r\+Length)
\begin{DoxyCompactList}\small\item\em I2C read/write functionality, to read and write at the same time. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
I2C function to read-\/write the I2C bus, based on D\+R\+A\+M\+CO code. 

\begin{DoxyVersion}{Version}
1.\+0 
\end{DoxyVersion}
\begin{DoxyAuthor}{Author}
Jona Cappelle \& Thomas Feys 
\end{DoxyAuthor}


\doxysubsection{Function Documentation}
\mbox{\Hypertarget{_i2_c_8h_adc2aa003a8bc13c866e90661fa908189}\label{_i2_c_8h_adc2aa003a8bc13c866e90661fa908189}} 
\index{I2C.h@{I2C.h}!IIC\_Init@{IIC\_Init}}
\index{IIC\_Init@{IIC\_Init}!I2C.h@{I2C.h}}
\doxysubsubsection{\texorpdfstring{IIC\_Init()}{IIC\_Init()}}
{\footnotesize\ttfamily void I\+I\+C\+\_\+\+Init (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Setup I2C functionality. 



Definition at line 50 of file I2\+C.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{50                    \{}
\DoxyCodeLine{51 }
\DoxyCodeLine{52     \textcolor{comment}{/* We use the standard I2C pins and ports, so no need to adjust */}}
\DoxyCodeLine{53     \textcolor{comment}{/*}}
\DoxyCodeLine{54 \textcolor{comment}{    i2cInit.port = I2C0;}}
\DoxyCodeLine{55 \textcolor{comment}{    i2cInit.sclPort = gpioPortD;}}
\DoxyCodeLine{56 \textcolor{comment}{    i2cInit.sclPin = 7;}}
\DoxyCodeLine{57 \textcolor{comment}{    i2cInit.sdaPort = gpioPortD;}}
\DoxyCodeLine{58 \textcolor{comment}{    i2cInit.sdaPin = 6;}}
\DoxyCodeLine{59 \textcolor{comment}{    i2cInit.i2cClhr = i2cClockHLRStandard;}}
\DoxyCodeLine{60 \textcolor{comment}{    i2cInit.i2cRefFreq = 0 ;}}
\DoxyCodeLine{61 \textcolor{comment}{    i2cInit.i2cMaxFreq = I2C\_FREQ\_STANDARD\_MAX;}}
\DoxyCodeLine{62 \textcolor{comment}{    i2cInit.portLocation = I2C\_PORT\_LOCATION; //zie datasheet {\ucr}controller (hashtag getal in pinout)}}
\DoxyCodeLine{63 \textcolor{comment}{*/}}
\DoxyCodeLine{64 }
\DoxyCodeLine{65     I2CSPM\_Init(\&\mbox{\hyperlink{_i2_c_8c_abcf7b773a2929ce5e37a7f186d0e7b6f}{i2cInit}});}
\DoxyCodeLine{66 \}}

\end{DoxyCode}
\mbox{\Hypertarget{_i2_c_8h_a64d2f470c338361bb82df486f8002b19}\label{_i2_c_8h_a64d2f470c338361bb82df486f8002b19}} 
\index{I2C.h@{I2C.h}!IIC\_ReadBuffer@{IIC\_ReadBuffer}}
\index{IIC\_ReadBuffer@{IIC\_ReadBuffer}!I2C.h@{I2C.h}}
\doxysubsubsection{\texorpdfstring{IIC\_ReadBuffer()}{IIC\_ReadBuffer()}}
{\footnotesize\ttfamily bool I\+I\+C\+\_\+\+Read\+Buffer (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{iic\+Address,  }\item[{uint8\+\_\+t}]{reg\+Command,  }\item[{uint8\+\_\+t $\ast$}]{r\+Buffer,  }\item[{uint8\+\_\+t}]{r\+Length }\end{DoxyParamCaption})}



I2C read functionality. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em iic\+Address} & 10bit I2C address\\
\hline
\mbox{\texttt{ in}}  & {\em reg\+Command} & Address that needs to be read\\
\hline
\mbox{\texttt{ in}}  & {\em r\+Buffer} & Address where the read data needs to be stored\\
\hline
\mbox{\texttt{ in}}  & {\em r\+Length} & Length of the data that has to be read \\
\hline
\end{DoxyParams}


Definition at line 135 of file I2\+C.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{135                                                                                                \{}
\DoxyCodeLine{136     I2C\_TransferSeq\_TypeDef seq;}
\DoxyCodeLine{137     I2C\_TransferReturn\_TypeDef ret;}
\DoxyCodeLine{138     uint8\_t i2c\_write\_data[1];}
\DoxyCodeLine{139 }
\DoxyCodeLine{140     seq.addr  = iicAddress;}
\DoxyCodeLine{141     seq.flags = I2C\_FLAG\_READ;}
\DoxyCodeLine{142     \textcolor{comment}{/* Select command to issue */}}
\DoxyCodeLine{143     i2c\_write\_data[0] = regCommand;}
\DoxyCodeLine{144     seq.buf[0].data   = i2c\_write\_data;}
\DoxyCodeLine{145     seq.buf[0].len    = 1;}
\DoxyCodeLine{146 }
\DoxyCodeLine{147     \textcolor{comment}{/* Select location/length of data to be read */}}
\DoxyCodeLine{148     seq.buf[1].data = rBuffer;}
\DoxyCodeLine{149     seq.buf[1].len  = rLength;}
\DoxyCodeLine{150 }
\DoxyCodeLine{151     ret = I2CSPM\_Transfer(\mbox{\hyperlink{_i2_c_8c_abcf7b773a2929ce5e37a7f186d0e7b6f}{i2cInit}}.port, \&seq);}
\DoxyCodeLine{152 }
\DoxyCodeLine{153     \textcolor{keywordflow}{if} (ret != i2cTransferDone) \{}
\DoxyCodeLine{154         *rBuffer = 0;}
\DoxyCodeLine{155         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{156     \}}
\DoxyCodeLine{157     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{158 \}}

\end{DoxyCode}
\mbox{\Hypertarget{_i2_c_8h_a20cf9a3b52c6a0e5b84b6e798c8dcb11}\label{_i2_c_8h_a20cf9a3b52c6a0e5b84b6e798c8dcb11}} 
\index{I2C.h@{I2C.h}!IIC\_Reset@{IIC\_Reset}}
\index{IIC\_Reset@{IIC\_Reset}!I2C.h@{I2C.h}}
\doxysubsubsection{\texorpdfstring{IIC\_Reset()}{IIC\_Reset()}}
{\footnotesize\ttfamily void I\+I\+C\+\_\+\+Reset (\begin{DoxyParamCaption}\item[{void}]{ }\end{DoxyParamCaption})}



Resets the I2C interface. 

\begin{DoxyNote}{Note}
Normally not needed, just in case
\end{DoxyNote}

\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em void} & \\
\hline
\end{DoxyParams}


Definition at line 77 of file I2\+C.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{77                     \{}
\DoxyCodeLine{78     I2C\_Reset(\mbox{\hyperlink{_i2_c_8c_abcf7b773a2929ce5e37a7f186d0e7b6f}{i2cInit}}.port);}
\DoxyCodeLine{79 \}}

\end{DoxyCode}
\mbox{\Hypertarget{_i2_c_8h_a47431e985fd340e0e1d8a112bfe9ddcc}\label{_i2_c_8h_a47431e985fd340e0e1d8a112bfe9ddcc}} 
\index{I2C.h@{I2C.h}!IIC\_WriteBuffer@{IIC\_WriteBuffer}}
\index{IIC\_WriteBuffer@{IIC\_WriteBuffer}!I2C.h@{I2C.h}}
\doxysubsubsection{\texorpdfstring{IIC\_WriteBuffer()}{IIC\_WriteBuffer()}}
{\footnotesize\ttfamily bool I\+I\+C\+\_\+\+Write\+Buffer (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{iic\+Address,  }\item[{uint8\+\_\+t $\ast$}]{w\+Buffer,  }\item[{uint8\+\_\+t}]{w\+Length }\end{DoxyParamCaption})}



I2C write functionality. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em iic\+Address} & 10bit I2C address\\
\hline
\mbox{\texttt{ in}}  & {\em w\+Buffer} & Address where the data is that needs to be written\\
\hline
\mbox{\texttt{ in}}  & {\em w\+Length} & Length of the data that has to be written \\
\hline
\end{DoxyParams}


Definition at line 95 of file I2\+C.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{95                                                                             \{}
\DoxyCodeLine{96     I2C\_TransferSeq\_TypeDef seq;}
\DoxyCodeLine{97     I2C\_TransferReturn\_TypeDef ret;}
\DoxyCodeLine{98     uint8\_t i2c\_read\_data[0];}
\DoxyCodeLine{99 }
\DoxyCodeLine{100     seq.addr  = iicAddress;}
\DoxyCodeLine{101     seq.flags = I2C\_FLAG\_WRITE;}
\DoxyCodeLine{102     \textcolor{comment}{/* Point to write buffer (contains command \& data) */}}
\DoxyCodeLine{103     seq.buf[0].data   = wBuffer;}
\DoxyCodeLine{104     seq.buf[0].len    = wLength;}
\DoxyCodeLine{105     \textcolor{comment}{/* Select location/length of data to be read */}}
\DoxyCodeLine{106     seq.buf[1].data = i2c\_read\_data;}
\DoxyCodeLine{107     seq.buf[1].len  = 0;}
\DoxyCodeLine{108 }
\DoxyCodeLine{109     ret = I2CSPM\_Transfer(\mbox{\hyperlink{_i2_c_8c_abcf7b773a2929ce5e37a7f186d0e7b6f}{i2cInit}}.port, \&seq);}
\DoxyCodeLine{110 }
\DoxyCodeLine{111     \textcolor{keywordflow}{if} (ret != i2cTransferDone) \{}
\DoxyCodeLine{112         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{113     \}}
\DoxyCodeLine{114 }
\DoxyCodeLine{115     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{116 \}}

\end{DoxyCode}
\mbox{\Hypertarget{_i2_c_8h_a06104f2b83b9e221737ba5a75c6edc4c}\label{_i2_c_8h_a06104f2b83b9e221737ba5a75c6edc4c}} 
\index{I2C.h@{I2C.h}!IIC\_WriteReadBuffer@{IIC\_WriteReadBuffer}}
\index{IIC\_WriteReadBuffer@{IIC\_WriteReadBuffer}!I2C.h@{I2C.h}}
\doxysubsubsection{\texorpdfstring{IIC\_WriteReadBuffer()}{IIC\_WriteReadBuffer()}}
{\footnotesize\ttfamily bool I\+I\+C\+\_\+\+Write\+Read\+Buffer (\begin{DoxyParamCaption}\item[{uint8\+\_\+t}]{iic\+Address,  }\item[{uint8\+\_\+t $\ast$}]{w\+Buffer,  }\item[{uint8\+\_\+t}]{w\+Length,  }\item[{uint8\+\_\+t $\ast$}]{r\+Buffer,  }\item[{uint8\+\_\+t}]{r\+Length }\end{DoxyParamCaption})}



I2C read/write functionality, to read and write at the same time. 


\begin{DoxyParams}[1]{Parameters}
\mbox{\texttt{ in}}  & {\em iic\+Address} & 10bit I2C address\\
\hline
\mbox{\texttt{ in}}  & {\em reg\+Command} & Address that needs to be read\\
\hline
\mbox{\texttt{ in}}  & {\em r\+Buffer} & Address where the read data needs to be stored\\
\hline
\mbox{\texttt{ in}}  & {\em r\+Length} & Length of the data that has to be read \\
\hline
\end{DoxyParams}


Definition at line 178 of file I2\+C.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{178                                                                                                                    \{}
\DoxyCodeLine{179     I2C\_TransferSeq\_TypeDef seq;}
\DoxyCodeLine{180     I2C\_TransferReturn\_TypeDef ret;}
\DoxyCodeLine{181 }
\DoxyCodeLine{182     seq.addr  = iicAddress;}
\DoxyCodeLine{183     seq.flags = I2C\_FLAG\_WRITE\_READ;}
\DoxyCodeLine{184     \textcolor{comment}{/* Point to write buffer (contains command \& data) */}}
\DoxyCodeLine{185     seq.buf[0].data   = wBuffer;}
\DoxyCodeLine{186     seq.buf[0].len    = wLength;}
\DoxyCodeLine{187 }
\DoxyCodeLine{188     \textcolor{comment}{/* Select location/length of data to be read */}}
\DoxyCodeLine{189     seq.buf[1].data = rBuffer;}
\DoxyCodeLine{190     seq.buf[1].len  = rLength;}
\DoxyCodeLine{191 }
\DoxyCodeLine{192     ret = I2CSPM\_Transfer(\mbox{\hyperlink{_i2_c_8c_abcf7b773a2929ce5e37a7f186d0e7b6f}{i2cInit}}.port, \&seq);}
\DoxyCodeLine{193 }
\DoxyCodeLine{194     \textcolor{keywordflow}{if} (ret != i2cTransferDone) \{}
\DoxyCodeLine{195         *rBuffer = 0;}
\DoxyCodeLine{196         \textcolor{keywordflow}{return} \textcolor{keyword}{false};}
\DoxyCodeLine{197     \}}
\DoxyCodeLine{198 }
\DoxyCodeLine{199     \textcolor{keywordflow}{return} \textcolor{keyword}{true};}
\DoxyCodeLine{200 \}}

\end{DoxyCode}
